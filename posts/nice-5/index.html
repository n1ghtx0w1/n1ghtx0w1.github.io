<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="NICE Challenge 5" /><meta name="author" content="Robert Head" /><meta property="og:locale" content="en" /><meta name="description" content="STIG Solutions [NG]" /><meta property="og:description" content="STIG Solutions [NG]" /><link rel="canonical" href="https://n1ghtx0w1.github.io//posts/nice-5/" /><meta property="og:url" content="https://n1ghtx0w1.github.io//posts/nice-5/" /><meta property="og:site_name" content="HeadSec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-06T22:00:00-06:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="NICE Challenge 5" /><meta name="twitter:site" content="@attacktheosi" /><meta name="twitter:creator" content="@Robert Head" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Robert Head"},"dateModified":"2022-08-21T00:56:27-05:00","datePublished":"2022-03-06T22:00:00-06:00","description":"STIG Solutions [NG]","headline":"NICE Challenge 5","mainEntityOfPage":{"@type":"WebPage","@id":"https://n1ghtx0w1.github.io//posts/nice-5/"},"url":"https://n1ghtx0w1.github.io//posts/nice-5/"}</script><title>NICE Challenge 5 | HeadSec</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="HeadSec"><meta name="application-name" content="HeadSec"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://avatars.githubusercontent.com/u/97073332?v=4/commons/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">HeadSec</a></div><div class="site-subtitle font-italic">Welcome to headsec.tech</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/n1ghtx0w1" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/attacktheosi" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['attacktheosi','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/robert-head-0x0" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>NICE Challenge 5</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-src="https://mohammaddarab.com/wp-content/uploads/2018/04/DoD-DISA-logos-as-JPEG-1024x307.jpg" class="preview-img bg" alt="Security Analyst" width="1000" height="400" data-proofer-ignore><h1 data-toc-skip>NICE Challenge 5</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/n1ghtx0w1">Robert Head</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1646625600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-03-06 </em> </span> <span> Updated <em class="timeago" data-ts="1661061387" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-08-21 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3066 words"> <em>17 min</em> read</span></div></div></div><div class="post-content"><h2 id="stig-solutions-ng"><span class="mr-2">STIG Solutions [NG]</span><a href="#stig-solutions-ng" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><strong>Author:</strong> Alexander Hillock</p><p><strong>Framework Category:</strong> Operate and Maintain</p><p><strong>Specialty Area:</strong> Systems Analysis</p><p><strong>Work Role:</strong> Systems Security Analyst</p><p><strong>Task Description:</strong> Implement security measures to resolve vulnerabilities, mitigate risks, and recommend security changes to system or system components as needed. (T0485)</p><h2 id="scenario"><span class="mr-2">Scenario</span><a href="#scenario" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>After a review, I was made aware that some of our computers are not up to security configuration standards, leaving the machines open to multiple vulnerabilities that could be catastrophic if exploited. I need you to configure specific machines to comply with specific configurations found in DISA’s (Defense Information Systems Agency) Security Technical Implementation Guide.</p><p><em><strong>Additional Information</strong></em></p><p>More details and objectives about this challenge will be introduced during the challenge meeting, which will start once you begin deploying the challenge.</p><p>You will be able to check your progress during this challenge using the check panel within the workspace once the challenge is deployed. The checks within the check panel report on the state of some or all of the required tasks within the challenge.</p><p>Once you have completed the requested tasks, you will need to document the methodology you used with as much detail and professionalism as necessary. This should be done on the documentation tab within the workspace once the challenge is deployed. Below the main documentation section be sure to include a tagged list of applications you used to complete the challenge.</p><p>Your username/password to access all virtual machines and services within the workspace will be the following… Username: playerone Password: password123</p><p>The username/password used to access the Firewall’s web interface within the workspace will be the following… Username: admin Password: password123</p><hr /><h2 id="mission-start"><span class="mr-2">Mission Start</span><a href="#mission-start" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>I began work on this challenge on 5 MAR 2022, at at 15:45 hours, with the following meeting:</p><blockquote><p><strong>Gary Thatcher:</strong></p><p>@playerone, It looks like some of our machines aren’t as secure as we might have thought, there is some configuration I’d like you to perform on the Prod-Web machine to close up some of the holes that are there.</p><p><strong>Ione Leventis:</strong></p><p>I’ve done some research for a good configuration guide and I’ve found something called a Security Technical Implementation Guide. I’ve gone ahead and dropped both the guide and the viewing tool on the Security-Desk. You should make sure the machine is configured with some of the CAT II specifications. Specifically, I have a range of the CAT II configs I’ll want you to implement.</p><p><strong>Richard LeGrand:</strong></p><p>WE HAVE VULNERABILITIES??!!! WHAT IS GOING ON??? GET THIS FIXED….YESTERDAY!!!!!!</p><p><strong>Ione Leventis:</strong></p><p>For now, I want you fix any findings you come accross within the range of rule 13 (V-204406) through rule 31 (V-204426). Just make sure you’re filtering via only CAT II rules. However, if you come accross any user specific fixes, please leave the nagios account alone, otherwise our MSP wont be able to monitor our environment anymore and that will cause a lot headaches for everyone.</p><p><strong>Ione Leventis:</strong></p><p>Oh, and make sure you don’t unzip the Red Hat Enterprise Linux STIG, just import it straight into the viewer itself. I know our Prod-Web is CentOS 7 but the rules I need you to cover will still apply. Keep in mind the STIG and STIG Viewer are both located on the Security-Desk, however the issues you will be solving are on Prod-Web.</p></blockquote><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 300'%3E%3C/svg%3E" align="center" data-src="https://raw.githubusercontent.com/n1ghtx0w1/WriteUps/main/NICE-Challenges/nice-5/img/nice-5-meeting.png" alt="meeting" width="600" height="300" data-proofer-ignore></p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 300'%3E%3C/svg%3E" align="center" data-src="https://raw.githubusercontent.com/n1ghtx0w1/WriteUps/main/NICE-Challenges/nice-5/img/OM2-map.jpg" alt="map" width="600" height="300" data-proofer-ignore></p><hr /><p>I logged into the Security-Desk, after the meeting, and used an ssh connection into Prod-Web.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 300'%3E%3C/svg%3E" align="center" data-src="https://raw.githubusercontent.com/n1ghtx0w1/WriteUps/main/NICE-Challenges/nice-5/img/nice-5-ssh.png" alt="ssh" width="600" height="300" data-proofer-ignore></p><p>I used the STIG viewer on the Security-Desk to filter and view the STIG rules that needed to be applied beginning with:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 300'%3E%3C/svg%3E" align="center" data-src="https://raw.githubusercontent.com/n1ghtx0w1/WriteUps/main/NICE-Challenges/nice-5/img/nice-5-stig-view-file.png" alt="stig file" width="600" height="300" data-proofer-ignore></p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 300'%3E%3C/svg%3E" align="center" data-src="https://raw.githubusercontent.com/n1ghtx0w1/WriteUps/main/NICE-Challenges/nice-5/img/nice-5-stig-viewer.png" alt="stig viewer" width="600" height="300" data-proofer-ignore></p><h3 id="vul-id-v-204406"><span class="mr-2">Vul ID V-204406</span><a href="#vul-id-v-204406" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> Verify the operating system uses “pwquality” to enforce the password complexity rules.</p><p>Check for the use of “pwquality” with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cat</span> /etc/pam.d/system-auth | <span class="nb">grep </span>pam_pwquality
</pre></table></code></div></div><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 300'%3E%3C/svg%3E" align="center" data-src="https://raw.githubusercontent.com/n1ghtx0w1/WriteUps/main/NICE-Challenges/nice-5/img/nice-5-check1.png" alt="stig viewer" width="600" height="300" data-proofer-ignore></p><p><strong>password required pam_pwquality.so retry=3</strong></p><p>If the command does not return an uncommented line containing the value <strong>“pam_pwquality.so”</strong>, this is a finding.</p><p>If the value of “retry” is set to “0” or greater than “3”, this is a finding.</p><p><strong>Fix Text:</strong> Configure the operating system to use “pwquality” to enforce password complexity rules.</p><p>Add the following line to “/etc/pam.d/system-auth” (or modify the line to have the required value):</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/pam.d/system-auth
</pre></table></code></div></div><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 300'%3E%3C/svg%3E" align="center" data-src="https://raw.githubusercontent.com/n1ghtx0w1/WriteUps/main/NICE-Challenges/nice-5/img/nice-5-check1-sudo-vim.png" alt="sudo vim" width="600" height="300" data-proofer-ignore></p><p><strong>password required pam_pwquality.so retry=3</strong></p><p><code class="language-plaintext highlighter-rouge">Note:</code> The value of “retry” should be between “1” and “3”.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 300'%3E%3C/svg%3E" align="center" data-src="https://raw.githubusercontent.com/n1ghtx0w1/WriteUps/main/NICE-Challenges/nice-5/img/nice-5-check1-sudo-vim-save.png" alt="save changes" width="600" height="300" data-proofer-ignore></p><h3 id="vul-id-v-204407"><span class="mr-2">Vul ID V-204407</span><a href="#vul-id-v-204407" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> Note: The value to require a number of upper-case characters to be set is expressed as a negative number in “/etc/security/pwquality.conf”.</p><p>Check the value for “ucredit” in “/etc/security/pwquality.conf” with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep </span>ucredit /etc/security/pwquality.conf
</pre></table></code></div></div><p><strong>ucredit = -1</strong></p><p>If the value of “ucredit” is not set to a negative value, this is a finding.</p><p><strong>Fix Text:</strong> Configure the operating system to enforce password complexity by requiring that at least one upper-case character be used by setting the “ucredit” option.</p><p>Add the following line to “/etc/security/pwquality.conf” (or modify the line to have the required value):</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/security/pwquality.conf
</pre></table></code></div></div><p><strong>ucredit = -1</strong></p><h3 id="vul-id-v-204408"><span class="mr-2">Vul ID V-204408</span><a href="#vul-id-v-204408" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> Note: The value to require a number of lower-case characters to be set is expressed as a negative number in “/etc/security/pwquality.conf”.</p><p>Check the value for “lcredit” in “/etc/security/pwquality.conf” with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep </span>lcredit /etc/security/pwquality.conf
</pre></table></code></div></div><p><strong>lcredit = -1</strong></p><p>If the value of “lcredit” is not set to a negative value, this is a finding.</p><p><strong>Fix Text:</strong> Configure the system to require at least one lower-case character when creating or changing a password.</p><p>Add or modify the following line in “/etc/security/pwquality.conf”:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/security/pwquality.conf
</pre></table></code></div></div><p><strong>lcredit = -1</strong></p><h3 id="vul-id-v-204409"><span class="mr-2">Vul ID V-204409</span><a href="#vul-id-v-204409" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> Note: The value to require a number of numeric characters to be set is expressed as a negative number in “/etc/security/pwquality.conf”.</p><p>Check the value for “dcredit” in “/etc/security/pwquality.conf” with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep </span>dcredit /etc/security/pwquality.conf
</pre></table></code></div></div><p><strong>dcredit = -1</strong></p><p>If the value of “dcredit” is not set to a negative value, this is a finding.</p><p><strong>Fix Text:</strong> Configure the operating system to enforce password complexity by requiring that at least one numeric character be used by setting the “dcredit” option.</p><p>Add the following line to /etc/security/pwquality.conf (or modify the line to have the required value):</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/security/pwquality.conf
</pre></table></code></div></div><p><strong>dcredit = -1</strong></p><h3 id="vul-id-v-204410"><span class="mr-2">Vul ID V-204410</span><a href="#vul-id-v-204410" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> Verify the operating system enforces password complexity by requiring that at least one special character be used.</p><p><code class="language-plaintext highlighter-rouge">Note:</code> The value to require a number of special characters to be set is expressed as a negative number in “/etc/security/pwquality.conf”.</p><p>Check the value for “ocredit” in “/etc/security/pwquality.conf” with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep </span>ocredit /etc/security/pwquality.conf
</pre></table></code></div></div><p><strong>ocredit=-1</strong></p><p>If the value of “ocredit” is not set to a negative value, this is a finding.</p><p><strong>Fix Text:</strong> Configure the operating system to enforce password complexity by requiring that at least one special character be used by setting the “ocredit” option.</p><p>Add the following line to “/etc/security/pwquality.conf” (or modify the line to have the required value):</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/security/pwquality.conf
</pre></table></code></div></div><p><strong>ocredit = -1</strong></p><h3 id="vul-id-v-204411"><span class="mr-2">Vul ID V-204411</span><a href="#vul-id-v-204411" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> The “difok” option sets the number of characters in a password that must not be present in the old password.</p><p>Check for the value of the “difok” option in “/etc/security/pwquality.conf” with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep </span>difok /etc/security/pwquality.conf
</pre></table></code></div></div><p><strong>difok = 8</strong></p><p>If the value of “difok” is set to less than “8”, this is a finding.</p><p><strong>Fix Text:</strong> Configure the operating system to require the change of at least eight of the total number of characters when passwords are changed by setting the “difok” option.</p><p>Add the following line to “/etc/security/pwquality.conf” (or modify the line to have the required value):</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/security/pwquality.conf
</pre></table></code></div></div><p><strong>difok = 8</strong></p><h3 id="vul-id-v-204412"><span class="mr-2">Vul ID V-204412</span><a href="#vul-id-v-204412" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> The “minclass” option sets the minimum number of required classes of characters for the new password (digits, upper-case, lower-case, others).</p><p>Check for the value of the “minclass” option in “/etc/security/pwquality.conf” with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep </span>minclass /etc/security/pwquality.conf<span class="s1">'
</span></pre></table></code></div></div><p><strong>minclass = 4</strong></p><p>If the value of “minclass” is set to less than “4”, this is a finding.</p><p><strong>Fix Text:</strong> Configure the operating system to require the change of at least four character classes when passwords are changed by setting the “minclass” option.</p><p>Add the following line to “/etc/security/pwquality.conf conf” (or modify the line to have the required value):</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/security/pwquality.conf
</pre></table></code></div></div><p><strong>minclass = 4</strong></p><h3 id="vul-id-v-204413"><span class="mr-2">Vul ID V-204413</span><a href="#vul-id-v-204413" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> The “maxrepeat” option sets the maximum number of allowed same consecutive characters in a new password.</p><p>Check for the value of the “maxrepeat” option in “/etc/security/pwquality.conf” with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep </span>maxrepeat /etc/security/pwquality.conf<span class="s1">'
</span></pre></table></code></div></div><p><strong>maxrepeat = 3</strong></p><p>If the value of “maxrepeat” is set to more than “3”, this is a finding.</p><p><strong>Fix Text:</strong> Configure the operating system to require the change of the number of repeating consecutive characters when passwords are changed by setting the “maxrepeat” option.</p><p>Add the following line to “/etc/security/pwquality.conf conf” (or modify the line to have the required value):</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/security/pwquality.conf
</pre></table></code></div></div><p><strong>maxrepeat = 3</strong></p><h3 id="vul-id-v-204414"><span class="mr-2">Vul ID V-204414</span><a href="#vul-id-v-204414" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> The “maxclassrepeat” option sets the maximum number of allowed same consecutive characters in the same class in the new password.</p><p>Check for the value of the “maxclassrepeat” option in “/etc/security/pwquality.conf” with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo grep </span>maxclassrepeat /etc/security/pwquality.conf 
</pre></table></code></div></div><p><strong>maxclassrepeat = 4</strong></p><p>If the value of “maxclassrepeat” is set to “0”, more than “4” or is commented out, this is a finding.</p><p><strong>Fix Text:</strong> Configure the operating system to require the change of the number of repeating characters of the same character class when passwords are changed by setting the “maxclassrepeat” option.</p><p>Add the following line to “/etc/security/pwquality.conf” conf (or modify the line to have the required value):</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/security/pwquality.conf
</pre></table></code></div></div><p><strong>maxclassrepeat = 4</strong></p><h3 id="vul-id-v-204415"><span class="mr-2">Vul ID V-204415</span><a href="#vul-id-v-204415" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> Verify the PAM system service is configured to store only encrypted representations of passwords. The strength of encryption that must be used to hash passwords for all accounts is SHA512.</p><p>Check that the system is configured to create SHA512 hashed passwords with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep </span>password /etc/pam.d/system-auth /etc/pam.d/password-auth
</pre></table></code></div></div><p>Outcome should look like following: /etc/pam.d/system-auth-ac:password sufficient pam_unix.so sha512 shadow try_first_pass use_authtok /etc/pam.d/password-auth:password sufficient pam_unix.so sha512 shadow try_first_pass use_authtok</p><p>If the “/etc/pam.d/system-auth” and “/etc/pam.d/password-auth” configuration files allow for password hashes other than <strong>SHA512</strong> to be used, this is a finding.</p><p><strong>Fix Text:</strong> Configure the operating system to store only <strong>SHA512</strong> encrypted representations of passwords.</p><p>Add the following line in “/etc/pam.d/system-auth”: pam_unix.so sha512 shadow try_first_pass use_authtok</p><p>Add the following line in “/etc/pam.d/password-auth”: pam_unix.so sha512 shadow try_first_pass use_authtok</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/pam.d/system-auth
</pre></table></code></div></div><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/pam.d/password-auth
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Note:</code> Manual changes to the listed files may be overwritten by the “authconfig” program. The “authconfig” program should not be used to update the configurations listed in this requirement.</p><h3 id="vul-id-v-204416"><span class="mr-2">Vul ID V-204416</span><a href="#vul-id-v-204416" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> Verify the system’s shadow file is configured to store only encrypted representations of passwords. The strength of encryption that must be used to hash passwords for all accounts is SHA512.</p><p>Check that the system is configured to create SHA512 hashed passwords with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep</span> <span class="nt">-i</span> encrypt /etc/login.defs
</pre></table></code></div></div><p><strong>ENCRYPT_METHOD SHA512</strong></p><p>If the “/etc/login.defs” configuration file does not exist or allows for password hashes other than SHA512 to be used, this is a finding.</p><p><strong>Fix Text:</strong> Configure the operating system to store only SHA512 encrypted representations of passwords.</p><p>Add or update the following line in “/etc/login.defs”:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/login.defs
</pre></table></code></div></div><p><strong>ENCRYPT_METHOD SHA512</strong></p><h3 id="vul-id-v-204417"><span class="mr-2">Vul ID V-204417</span><a href="#vul-id-v-204417" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> Verify the user and group account administration utilities are configured to store only encrypted representations of passwords. The strength of encryption that must be used to hash passwords for all accounts is “SHA512”.</p><p>Check that the system is configured to create “SHA512” hashed passwords with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep</span> <span class="nt">-i</span> sha512 /etc/libuser.conf
</pre></table></code></div></div><p><strong>crypt_style = sha512</strong></p><p>If the “crypt_style” variable is not set to “sha512”, is not in the defaults section, is commented out, or does not exist, this is a finding.</p><p><strong>Fix Text:</strong> Configure the operating system to store only SHA512 encrypted representations of passwords.</p><p>Add or update the following line in “/etc/libuser.conf” in the [defaults] section:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/libuser.conf
</pre></table></code></div></div><p><strong>crypt_style = sha512</strong></p><h3 id="vul-id-v-204418"><span class="mr-2">Vul ID V-204418</span><a href="#vul-id-v-204418" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> Verify the operating system enforces 24 hours/1 day as the minimum password lifetime for new user accounts.</p><p>Check for the value of “PASS_MIN_DAYS” in “/etc/login.defs” with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep</span> <span class="nt">-i</span> pass_min_days /etc/login.defs
</pre></table></code></div></div><p><strong>PASS_MIN_DAYS 1</strong></p><p>If the “PASS_MIN_DAYS” parameter value is not “1” or greater, or is commented out, this is a finding.</p><p><strong>Fix Text:</strong> Configure the operating system to enforce 24 hours/1 day as the minimum password lifetime.</p><p>Add the following line in “/etc/login.defs” (or modify the line to have the required value):</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/login.defs
</pre></table></code></div></div><p><strong>PASS_MIN_DAYS 1</strong></p><h3 id="vul-id-v-204419"><span class="mr-2">Vul ID V-204419</span><a href="#vul-id-v-204419" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> Check whether the minimum time period between password changes for each user account is one day or greater.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo awk</span> <span class="nt">-F</span>: <span class="s1">'$4 &lt; 1 {print $1 " " $4}'</span> /etc/shadow
</pre></table></code></div></div><p>If any results are returned that are not associated with a system account, this is a finding.</p><p><strong>Fix Text:</strong> Configure non-compliant accounts to enforce a 24 hours/1 day minimum password lifetime:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>chage <span class="nt">-m</span> 1 <span class="o">[</span>user]
</pre></table></code></div></div><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 300'%3E%3C/svg%3E" align="center" data-src="https://raw.githubusercontent.com/n1ghtx0w1/WriteUps/main/NICE-Challenges/nice-5/img/nice-5-chage.png" alt="Chage" width="600" height="300" data-proofer-ignore></p><h3 id="vul-id-v-204420"><span class="mr-2">Vul ID V-204420</span><a href="#vul-id-v-204420" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> If passwords are not being used for authentication, this is Not Applicable.</p><p>Verify the operating system enforces a 60-day maximum password lifetime restriction for new user accounts.</p><p>Check for the value of “PASS_MAX_DAYS” in “/etc/login.defs” with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep</span> <span class="nt">-i</span> pass_max_days /etc/login.defs
</pre></table></code></div></div><p><strong>PASS_MAX_DAYS 60</strong></p><p>If the “PASS_MAX_DAYS” parameter value is not 60 or less, or is commented out, this is a finding.</p><p><strong>Fix Text:</strong> Configure the operating system to enforce a 60-day maximum password lifetime restriction.</p><p>Add the following line in “/etc/login.defs” (or modify the line to have the required value):</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/login.defs
</pre></table></code></div></div><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 300'%3E%3C/svg%3E" align="center" data-src="https://raw.githubusercontent.com/n1ghtx0w1/WriteUps/main/NICE-Challenges/nice-5/img/nice-5-60-days.png" alt="Days" width="600" height="300" data-proofer-ignore></p><p><strong>PASS_MAX_DAYS 60</strong></p><h3 id="vul-id-v-204421"><span class="mr-2">Vul ID V-204421</span><a href="#vul-id-v-204421" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> Check whether the maximum time period for existing passwords is restricted to 60 days.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo awk</span> <span class="nt">-F</span>: <span class="s1">'$5 &gt; 60 {print $1 " " $5}'</span> /etc/shadow
</pre></table></code></div></div><p>If any results are returned that are not associated with a system account, this is a finding.</p><p><strong>Fix Text:</strong> Configure non-compliant accounts to enforce a 60-day maximum password lifetime restriction.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>chage <span class="nt">-M</span> 60 <span class="o">[</span>user]
</pre></table></code></div></div><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 300'%3E%3C/svg%3E" align="center" data-src="https://raw.githubusercontent.com/n1ghtx0w1/WriteUps/main/NICE-Challenges/nice-5/img/nice-5-change-60-days.png" alt="Change" width="600" height="300" data-proofer-ignore></p><h3 id="vul-id-v-204422"><span class="mr-2">Vul ID V-204422</span><a href="#vul-id-v-204422" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> Verify the operating system prohibits password reuse for a minimum of five generations.</p><p>Check for the value of the “remember” argument in “/etc/pam.d/system-auth” and “/etc/pam.d/password-auth” with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep</span> <span class="nt">-i</span> remember /etc/pam.d/system-auth /etc/pam.d/password-auth
</pre></table></code></div></div><p><strong>password requisite pam_pwhistory.so use_authtok remember=5 retry=3</strong></p><p>If the line containing the “pam_pwhistory.so” line does not have the “remember” module argument set, is commented out, or the value of the “remember” module argument is set to less than “5”, this is a finding.</p><p><strong>Fix Text:</strong> Configure the operating system to prohibit password reuse for a minimum of five generations.</p><p>Add the following line in “/etc/pam.d/system-auth” and “/etc/pam.d/password-auth” (or modify the line to have the required value):</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/pam.d/password-auth
</pre></table></code></div></div><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 300'%3E%3C/svg%3E" align="center" data-src="https://raw.githubusercontent.com/n1ghtx0w1/WriteUps/main/NICE-Challenges/nice-5/img/nice-5-pwhist-days.png" alt="Pw Hist" width="600" height="300" data-proofer-ignore></p><p><strong>password requisite pam_pwhistory.so use_authtok remember=5 retry=3</strong></p><p><code class="language-plaintext highlighter-rouge">Note:</code> Manual changes to the listed files may be overwritten by the “authconfig” program. The “authconfig” program should not be used to update the configurations listed in this requirement.</p><h3 id="vul-id-v-204423"><span class="mr-2">Vul ID V-204423</span><a href="#vul-id-v-204423" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> Verify the operating system enforces a minimum 15-character password length. The “minlen” option sets the minimum number of characters in a new password.</p><p>Check for the value of the “minlen” option in “/etc/security/pwquality.conf” with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep </span>minlen /etc/security/pwquality.conf
</pre></table></code></div></div><p><strong>minlen = 15</strong></p><p>If the command does not return a “minlen” value of 15 or greater, this is a finding.</p><p><strong>Fix Text:</strong> Configure operating system to enforce a minimum 15-character password length.</p><p>Add the following line to “/etc/security/pwquality.conf” (or modify the line to have the required value):</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/security/pwquality.conf
</pre></table></code></div></div><p><strong>minlen = 15</strong></p><h3 id="vul-id-v-204424"><span class="mr-2">Vul ID V-204424</span><a href="#vul-id-v-204424" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> To verify that null passwords cannot be used, run the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep </span>nullok /etc/pam.d/system-auth /etc/pam.d/password-auth
</pre></table></code></div></div><p>If this produces any output, it may be possible to log on with accounts with empty passwords.</p><p>If null passwords can be used, this is a finding.</p><p><strong>Fix Text:</strong> If an account is configured for password authentication but does not have an assigned password, it may be possible to log on to the account without authenticating.</p><p>Remove any instances of the <strong>“nullok”</strong> option in “/etc/pam.d/system-auth” and “/etc/pam.d/password-auth” to prevent logons with empty passwords.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/pam.d/system-auth
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Note:</code> Manual changes to the listed files may be overwritten by the “authconfig” program. The “authconfig” program should not be used to update the configurations listed in this requirement.</p><h3 id="vul-id-v-204425"><span class="mr-2">Vul ID V-204425</span><a href="#vul-id-v-204425" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> To determine how the SSH daemon’s “PermitEmptyPasswords” option is set, run the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep</span> <span class="nt">-i</span> PermitEmptyPasswords /etc/ssh/sshd_config
</pre></table></code></div></div><p><strong>PermitEmptyPasswords no</strong></p><p>If no line, a commented line, or a line indicating the value “no” is returned, the required value is set.</p><p>If the required value is not set, this is a finding.</p><p><strong>Fix Text:</strong> To explicitly disallow remote logon from accounts with empty passwords, add or correct the following line in “/etc/ssh/sshd_config”:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/ssh/sshd_config
</pre></table></code></div></div><p><strong>PermitEmptyPasswords no</strong></p><p>The SSH service must be restarted for changes to take effect. Any accounts with empty passwords should be disabled immediately, and PAM configuration should prevent users from being able to assign themselves empty passwords.</p><h3 id="vul-id-v-204426"><span class="mr-2">Vul ID V-204426</span><a href="#vul-id-v-204426" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Check Text:</strong> If passwords are not being used for authentication, this is Not Applicable.</p><p>Verify the operating system disables account identifiers (individuals, groups, roles, and devices) after the password expires with the following command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep</span> <span class="nt">-i</span> inactive /etc/default/useradd
</pre></table></code></div></div><p><strong>INACTIVE=35</strong></p><p>If “INACTIVE” is set to “-1”, a value greater than “35”, is commented out, or is not defined, this is a finding.</p><p><strong>Fix Text:</strong> Configure the operating system to disable account identifiers (individuals, groups, roles, and devices) 35 days after the password expires.</p><p>Add the following line to “/etc/default/useradd” (or modify the line to have the required value):</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>vim /etc/default/useradd
</pre></table></code></div></div><p><strong>INACTIVE=35</strong></p><p>DoD recommendation is 35 days, but a lower value is acceptable. The value “-1” will disable this feature, and “0” will disable the account immediately after the password expires.</p><hr /><p>I completed my task by setting the rules according to <strong>U_RHEL_7_V3R6_STIG</strong> for the prod-web server as requested.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 300'%3E%3C/svg%3E" align="center" data-src="https://raw.githubusercontent.com/n1ghtx0w1/WriteUps/main/NICE-Challenges/nice-5/img/nice-5-desired-state.png" alt="Desired State" width="600" height="300" data-proofer-ignore></p><hr /><p>Each NICE Challenge has the following core elements: a narrative-driven scenario, a business environment (workspace), and a set of technical objectives and/or a written deliverable. Each of these elements is developed to immerse the player (student) in a real-world experience and create a valuable set of data allowing their curator (educator) to judge their readiness for the workforce.</p><p><em>About The <a href="https://nice-challenge.com/">NICE</a> Challenge Project</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/nice-challenge/'>NICE Challenge</a>, <a href='/categories/writeup/'>Writeup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/nice/" class="post-tag no-text-decoration" >nice</a> <a href="/tags/challenge/" class="post-tag no-text-decoration" >challenge</a> <a href="/tags/blue-team/" class="post-tag no-text-decoration" >blue team</a> <a href="/tags/cyber-defense/" class="post-tag no-text-decoration" >cyber defense</a> <a href="/tags/cyber-security/" class="post-tag no-text-decoration" >cyber security</a> <a href="/tags/wgu-cyber-security-club/" class="post-tag no-text-decoration" >wgu cyber security club</a> <a href="/tags/system-administration/" class="post-tag no-text-decoration" >system administration</a> <a href="/tags/cyber-defense-edition/" class="post-tag no-text-decoration" >cyber defense edition</a> <a href="/tags/nice-challenge-5/" class="post-tag no-text-decoration" >nice challenge 5</a> <a href="/tags/investigate/" class="post-tag no-text-decoration" >investigate</a> <a href="/tags/dod/" class="post-tag no-text-decoration" >dod</a> <a href="/tags/department-of-defense/" class="post-tag no-text-decoration" >department of defense</a> <a href="/tags/stig/" class="post-tag no-text-decoration" >stig</a> <a href="/tags/stig-rules/" class="post-tag no-text-decoration" >stig rules</a> <a href="/tags/system-security-analyst/" class="post-tag no-text-decoration" >system security analyst</a> <a href="/tags/systems-analyst/" class="post-tag no-text-decoration" >systems analyst</a> <a href="/tags/operate-and-maintain/" class="post-tag no-text-decoration" >operate and maintain</a> <a href="/tags/resolve-vulns/" class="post-tag no-text-decoration" >resolve vulns</a> <a href="/tags/harden-server/" class="post-tag no-text-decoration" >harden server</a> <a href="/tags/red-hat-enterprise-linux-stig/" class="post-tag no-text-decoration" >Red Hat Enterprise Linux STIG</a> <a href="/tags/security-technical-implementation-guide/" class="post-tag no-text-decoration" >Security Technical Implementation Guide</a> <a href="/tags/cat-ii/" class="post-tag no-text-decoration" >CAT II</a> <a href="/tags/alexander-hillock/" class="post-tag no-text-decoration" >Alexander Hillock</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=NICE Challenge 5 - HeadSec&amp;url=https://n1ghtx0w1.github.io//posts/nice-5/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=NICE Challenge 5 - HeadSec&amp;u=https://n1ghtx0w1.github.io//posts/nice-5/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://n1ghtx0w1.github.io//posts/nice-5/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="" data-toggle="tooltip" data-placement="top" title="" target="_blank" rel="noopener" aria-label=""> <i class="fa-fw "></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/stuxnet/">The Stuxnet Worm</a><li><a href="/posts/mitre-list/">MITRE Most Dangerous Software Weakness 2023</a><li><a href="/posts/moveit/">MOVEit</a><li><a href="/posts/cjis/">CJIS Compliance & Audits</a><li><a href="/posts/wannacry/">WannaCry Ransomware Attack</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/cybersecurity/">cybersecurity</a> <a class="post-tag" href="/tags/cyber/">cyber</a> <a class="post-tag" href="/tags/computer-fraud-and-abuse-act/">computer fraud and abuse act</a> <a class="post-tag" href="/tags/electronic-communications-privacy-act/">electronic communications privacy act</a> <a class="post-tag" href="/tags/data-integrity/">data integrity</a> <a class="post-tag" href="/tags/authentication/">authentication</a> <a class="post-tag" href="/tags/authorization/">authorization</a> <a class="post-tag" href="/tags/blue-team/">blue team</a> <a class="post-tag" href="/tags/data-availability/">data availability</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/nice-3/"><div class="card-body"> <em class="timeago small" data-ts="1644205500" > 2022-02-06 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NICE Challenge 3</h3><div class="text-muted small"><p> Systems Administration: Cyber Defense Edition Write-Up Author: Agustin Castro Framework Category: Protect and Defend Specialty Area: Cybersecurity Defense Infrastructure Support Work Role: Cybe...</p></div></div></a></div><div class="card"> <a href="/posts/nice-2/"><div class="card-body"> <em class="timeago small" data-ts="1643348700" > 2022-01-27 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NICE Challenge 2</h3><div class="text-muted small"><p> Summary of Today’s Challenge Preventative Protection: Thwarting the Imminent Threat Write-Up On January 23, 2022, at approximately 16:30 hours CST, I was given notice of an impending EternalBlue ...</p></div></div></a></div><div class="card"> <a href="/posts/nice-1/"><div class="card-body"> <em class="timeago small" data-ts="1643346000" > 2022-01-27 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NICE Challenge 1</h3><div class="text-muted small"><p> Summary of Today’s Challenge I began my work, on 16-Jan-2022, by accessing my security-desk, and remoting into web-dev via ssh to 172.16.20.11. Immediately I made a backup of the docker container...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/nice-4/" class="btn btn-outline-primary" prompt="Older"><p>NICE Challenge 4</p></a> <a href="/posts/a-plus/" class="btn btn-outline-primary" prompt="Newer"><p>CompTIA A+ Core 1 (220-1101) Study Material</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/attacktheosi">Robert Head</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by - n1ghtx0w1</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/cybersecurity/">cybersecurity</a> <a class="post-tag" href="/tags/cyber/">cyber</a> <a class="post-tag" href="/tags/computer-fraud-and-abuse-act/">computer fraud and abuse act</a> <a class="post-tag" href="/tags/electronic-communications-privacy-act/">electronic communications privacy act</a> <a class="post-tag" href="/tags/data-integrity/">data integrity</a> <a class="post-tag" href="/tags/authentication/">authentication</a> <a class="post-tag" href="/tags/authorization/">authorization</a> <a class="post-tag" href="/tags/blue-team/">blue team</a> <a class="post-tag" href="/tags/data-availability/">data availability</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
